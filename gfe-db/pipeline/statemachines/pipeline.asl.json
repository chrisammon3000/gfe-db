{
    "StartAt": "Build & Load IPD-IMGT/HLA Release",
    "States": {
        "Build & Load IPD-IMGT/HLA Release": {
            "Type": "Map",
            "Next": "Finish",
            "MaxConcurrency": 1,
            "Iterator": {
                "StartAt": "Generate CSV files",
                "States": {
                    "Generate CSV files": {
                        "Type": "Task",
                        "Resource": "arn:aws:states:::batch:submitJob.sync",
                        "ResultPath": null,
                        "Next": "Invoke Cypher Load Query",
                        "Parameters": {
                            "JobDefinition": "${BuildJobDefinition}",
                            "JobName": "${BuildJobName}",
                            "JobQueue": "${BuildJobQueue}",
                            "ContainerOverrides": {
                                "Environment": [
                                    {
                                        "Name": "RELEASES",
                                        "Value.$": "$.RELEASES"
                                    },
                                    {
                                        "Name": "ALIGN",
                                        "Value.$": "$.ALIGN"
                                    },
                                    {
                                        "Name": "KIR",
                                        "Value.$": "$.KIR"
                                    },
                                    {
                                        "Name": "MEM_PROFILE",
                                        "Value.$": "$.MEM_PROFILE"
                                    },
                                    {
                                        "Name": "LIMIT",
                                        "Value.$": "$.LIMIT"
                                    }
                                ]
                            }
                        }
                    },
                    "Invoke Cypher Load Query": {
                        "Type": "Task",
                        "Resource": "${InvokeLoadScriptFunctionArn}",
                        "Next": "Load Neo4j"
                    },
                    "Load Neo4j": {
                        "Type": "Task",
                        "Resource": "${LoadNeo4jActivityArn}",
                        "HeartbeatSeconds": 10,
                        "End": true
                      }
                }
            }
        },
        "Finish": {
            "Type": "Succeed"
        }
    }
}
